---
layout: post
title: 钉钉群机器人 -- 每日推送 之 定时推送
date: 2020-10-25
Author: 小萌 
tags: [技术分享]
comments: true
toc: true

---



> 本文是实现定时请求写好的post请求，已实现定时推送

### 主要思想

采用linux服务器上crontab的定时运行程序，实现定时推送。

#### crontab介绍

Linux crontab是用来定期执行程序的命令。

当安装完成操作系统之后，默认便会启动此任务调度命令。

crond 命令每分锺会定期检查是否有要执行的工作，如果有要执行的工作便会自动执行该工作。

**注意：**新创建的 cron 任务，不会马上执行，至少要过 2 分钟后才可以，当然你可以重启 cron 来马上执行。

而 linux 任务调度的工作主要分为以下两类：

- 1、系统执行的工作：系统周期性所要执行的工作，如备份系统数据、清理缓存
- 2、个人执行的工作：某个用户定期要做的工作，例如每隔10分钟检查邮件服务器是否有新信，这些工作可由每个用户自行设置

#### crontab语法

```
crontab [ -u user ] file
```

或

```
crontab [ -u user ] { -l | -r | -e }
```

**说明：**

crontab 是用来让使用者在固定时间或固定间隔执行程序之用，换句话说，也就是类似使用者的时程表。

-u user 是指设定指定 user 的时程表，这个前提是你必须要有其权限(比如说是 root)才能够指定他人的时程表。如果不使用 -u user 的话，就是表示设定自己的时程表。

**参数说明**：

- -e : 执行文字编辑器来设定时程表，内定的文字编辑器是 VI，如果你想用别的文字编辑器，则请先设定 VISUAL 环境变数来指定使用那个文字编辑器(比如说 setenv VISUAL joe)
- -r : 删除目前的时程表
- -l : 列出目前的时程表

###### 笔记

> crontab的定时功能就好似手机上的闹钟差不多，只不过crontab运行的是自定义命令。
>
> crontab -e   ---> 编辑当前的时程表
>
> crontab -l    ---> 查看当前生效的定时任务
>
> crontab -r   ---->删除当前时程表
>
> 三个命令比较常见，需谨记

![img](https://i.loli.net/2020/10/25/4rfTqFmGUazdISy.png)

前五位分别为：分钟、小时、几号、月份、星期

后一位是应该执行的脚本。

需要注意的是，crontab程序需要安装的。

这里，简单例举一下，鄙人实现定时发送的crontab信息。

![image-20201025193527035](https://i.loli.net/2020/10/25/64cR2mgINfGDPUA.png)

这里，红框可以解释为，每天6点40分，使用本机的curl命令，访问robot.php程序。而php程序就是我们构造的post请求。这样就实现了定时推送的功能。

到这里，实现钉钉群机器人的定时推送功能基本上可以正常使用了。

